{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Vulnlog Schema",
  "description": "Validates Vulnlog YAML files.",
  "type": "object",
  "properties": {
    "include": {
      "title": "Include Files",
      "description": "TODO",
      "$ref": "#/$defs/include"
    },
    "release-groups": {
      "title": "Release Groups",
      "description": "TODO",
      "$ref": "#/$defs/release-groups"
    },
    "releases": {
      "title": "Releases",
      "description": "TODO",
      "$ref": "#/$defs/releases"
    },
    "reporter-pipelines": {
      "title": "Reporter Pipelines",
      "description": "TODO",
      "$ref": "#/$defs/reporter-pipelines"
    },
    "reporters": {
      "title": "Reporters",
      "description": "TODO",
      "$ref": "#/$defs/reporters"
    },
    "vulnerabilities": {
      "title": "Vulnerabilities",
      "description": "TODO",
      "$ref": "#/$defs/vulnerabilities"
    }
  },
  "additionalProperties": false,
  "$defs": {
    "https://vulnlog.dev/release-groups.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Release Groups Schema",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "title": "Release Group Identifier",
            "description": "TODO",
            "type": "string"
          },
          "name": {
            "title": "Name of the Release Group",
            "description": "TODO",
            "type": "string"
          },
          "ref-ids": {
            "title": "Release Identifier",
            "description": "TODO",
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      }
    },
    "https://vulnlog.dev/releases.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Releases Schema",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "title": "Release Identifier",
            "description": "TODO",
            "type": "string"
          },
          "name": {
            "title": "Release Name",
            "description": "TODO",
            "examples": [ "Product 1.0.0" ],
            "type": "string"
          },
          "release-date": {
            "title": "Release Date",
            "description": "TODO",
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
            "format": "date"
          },
          "version": {
            "title": "Release Version",
            "description": "TODO",
            "examples": [ "1.0.0" ],
            "type": "string"
          }
        }
      }
    },
    "https://vulnlog.dev/reporter-pipelines.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Reporter Pipeline Schema",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "title": "Reporter Pipeline Identifier",
            "description": "TODO",
            "type": "string"
          },
          "lifetime": {
            "title": "Pipeline Lifetime",
            "description": "TODO",
            "type": "object",
            "properties": {
              "end": {
                "title": "End date of this pipeline",
                "description": "TODO",
                "type": "string",
                "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
                "format": "date"
              },
              "start": {
                "title": "Start date of this pipeline",
                "description": "TODO",
                "type": "string",
                "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
                "format": "date"
              }
            }
          },
          "name": {
            "title": "Reporter Pipeline Name",
            "description": "TODO",
            "type": "string"
          },
          "reporter-ref-id": {
            "title": "Reporter",
            "description": "TODO",
            "type": "string"
          }
        }
      }
    },
    "https://vulnlog.dev/reporters.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Reporters Schema",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "title": "Reporter Identifier",
            "description": "TODO",
            "type": "string"
          },
          "name": {
            "title": "Reporter Name",
            "description": "TODO",
            "type": "string"
          },
          "product": {
            "title": "Reporter Product",
            "description": "TODO",
            "type": "string"
          }
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.analysis.verdict.affected.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Analysis Verdict Affected Schema",
      "type": "object",
      "properties": {
        "severity": {
          "title": "Severity",
          "description": "TODO",
          "enum": [ "Critical", "High", "Medium", "Low" ]
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.analysis.verdict.notaffected.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Analysis Verdict Not Affected Schema",
      "type": "object",
      "properties": {
        "vex": {
          "title": "VEX Justification",
          "description": "TODO",
          "enum": [
            "Component not present",
            "Inline mitigations already exist",
            "Vulnerable code cannot be controlled by adversary",
            "Vulnerable code not in execute path",
            "Vulnerable code not present"
          ]
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.analysis.verdict.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Analysis Verdict Schema",
      "type": "object",
      "properties": {
        "not-affected": {
          "title": "Not Affected",
          "description": "TODO",
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.analysis.verdict.vulnlog.schema.json/$defs/not-affected"
        },
        "affected": {
          "title": "Affected",
          "description": "TODO",
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.analysis.verdict.vulnlog.schema.json/$defs/affected"
        }
      },
      "$defs": {
        "not-affected": {
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.analysis.verdict.notaffected.vulnlog.schema.json"
        },
        "affected": {
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.analysis.verdict.affected.vulnlog.schema.json"
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.analysis.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Analysis Schema",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "at": {
            "title": "Analysis Date",
            "description": "Date when this vulnerability report was analyzed. When left empty, the date of the first report is used implicitly. Format: YYYY-MM-DD",
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
            "format": "date"
          },
          "reasoning": {
            "title": "Reasoning",
            "description": "TODO",
            "type": "string",
            "minLength": 2
          },
          "verdict": {
            "title": "Verdict",
            "description": "TODO",
            "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.analysis.vulnlog.schema.json/$defs/verdict",
            "type": "object"
          }
        }
      },
      "$defs": {
        "verdict": {
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.analysis.verdict.vulnlog.schema.json"
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.include.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Include Schema",
      "type": "object",
      "properties": {
        "releases": {
          "title": "Include Releases",
          "description": "TODO",
          "type": "object",
          "properties": {
            "file": {
              "title": "File to include",
              "description": "TODO",
              "type": "string"
            },
            "ref-ids": {
              "title": "Release IDs to Reference from",
              "description": "TODO",
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "reporters": {
          "title": "Include Reporters",
          "description": "TODO",
          "type": "object",
          "properties": {
            "file": {
              "title": "File to include",
              "description": "TODO",
              "type": "string"
            },
            "pipeline-ref-ids": {
              "title": "Reporter Pipeline References",
              "description": "TODO",
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "reporter-ref-ids": {
              "title": "Reporter References",
              "description": "TODO",
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.reports.suppression.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Report Suppression Schema",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "on": {
            "title": "Suppress on Releases",
            "description": "TODO",
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            ]
          },
          "until": {
            "title": "Suppress Until",
            "description": "TODO",
            "examples": [ "1970-01-01" ],
            "type": "string",
            "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
            "format": "date"
          }
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.reports.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Reports Schema",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "on": {
            "title": "Reported Release",
            "description": "TODO",
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            ]
          },
          "suppression": {
            "title": "Suppress this Report",
            "description": "TODO",
            "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.reports.vulnlog.schema.json/$defs/suppression"
          },
          "vuln-id": {
            "title": "Vulnerability ID",
            "description": "TODO",
            "examples": [ "CVE-2021-44228" ],
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            ]
          }
        }
      },
      "$defs": {
        "suppression": {
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.reports.suppression.vulnlog.schema.json"
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.resolutions.accept.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Resolutions Accept Schema",
      "type": "object",
      "properties": {
        "note": {
          "title": "Note",
          "description": "TODO",
          "type": "string"
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.resolutions.fix.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Resolutions Fxi Schema",
      "type": "object",
      "properties": {
        "note": {
          "title": "Note",
          "description": "TODO",
          "type": "string"
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.resolutions.rebuild.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Resolutions Rebuild Schema",
      "type": "object",
      "properties": {
        "note": {
          "title": "Note",
          "description": "TODO",
          "type": "string"
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.resolutions.update.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Resolutions Update Schema",
      "type": "object",
      "properties": {
        "maven-dependency": {
          "title": "Maven Dependency",
          "description": "TODO",
          "type": "string",
          "pattern": "^.*:.*:.*$"
        },
        "note": {
          "title": "Note",
          "description": "TODO",
          "type": "string"
        },
        "resolved-at": {
          "title": "Resolved at Date",
          "description": "TODO",
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
          "format": "date"
        },
        "to": {
          "title": "To Version",
          "description": "TODO",
          "type": "string"
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.resolutions.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Resolutions Schema",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "accept": {
            "title": "Accept",
            "description": "Accept a vulnerability.",
            "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.resolutions.vulnlog.schema.json/$defs/accept",
            "type": "object"
          },
          "fix": {
            "title": "Fix",
            "description": "Fix code parts in the project.",
            "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.resolutions.vulnlog.schema.json/$defs/fix",
            "type": "object"
          },
          "rebuild": {
            "title": "Rebuild",
            "description": "Rebuild a product component.",
            "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.resolutions.vulnlog.schema.json/$defs/rebuild",
            "type": "object"
          },
          "update": {
            "title": "Update",
            "description": "Update a dependency to a specific version.",
            "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.resolutions.vulnlog.schema.json/$defs/update",
            "type": "object"
          }
        }
      },
      "$defs": {
        "accept": {
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.resolutions.accept.vulnlog.schema.json"
        },
        "fix": {
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.resolutions.fix.vulnlog.schema.json"
        },
        "rebuild": {
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.resolutions.rebuild.vulnlog.schema.json"
        },
        "update": {
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.resolutions.update.vulnlog.schema.json"
        }
      }
    },
    "https://vulnlog.dev/vulnerabilities.vulnlog.schema.json": {
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "Vulnlog Vulnerability Schema",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "analysis": {
            "title": "Analysis",
            "description": "TODO",
            "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.vulnlog.schema.json/$defs/analysis"
          },
          "cwe": {
            "title": "Common Weakness Enumeration",
            "description": "TODO",
            "type": "integer",
            "minimum": 11
          },
          "desc": {
            "title": "Vulnerability Description",
            "description": "TODO",
            "type": "string",
            "minLength": 3
          },
          "reports": {
            "title": "Reports",
            "description": "TODO",
            "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.vulnlog.schema.json/$defs/reports"
          },
          "resolutions": {
            "title": "Resolutions",
            "description": "TODO",
            "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.vulnlog.schema.json/$defs/resolutions"
          }
        },
        "additionalProperties": false
      },
      "$defs": {
        "analysis": {
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.analysis.vulnlog.schema.json"
        },
        "reports": {
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.reports.vulnlog.schema.json"
        },
        "resolutions": {
          "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.resolutions.vulnlog.schema.json"
        }
      }
    },
    "include": {
      "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.include.vulnlog.schema.json"
    },
    "release-groups": {
      "$ref": "#/$defs/https:~1~1vulnlog.dev~1release-groups.vulnlog.schema.json"
    },
    "releases": {
      "$ref": "#/$defs/https:~1~1vulnlog.dev~1releases.vulnlog.schema.json"
    },
    "reporter-pipelines": {
      "$ref": "#/$defs/https:~1~1vulnlog.dev~1reporter-pipelines.vulnlog.schema.json"
    },
    "reporters": {
      "$ref": "#/$defs/https:~1~1vulnlog.dev~1reporters.vulnlog.schema.json"
    },
    "vulnerabilities": {
      "$ref": "#/$defs/https:~1~1vulnlog.dev~1vulnerabilities.vulnlog.schema.json"
    }
  }
}
